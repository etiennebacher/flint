[{"path":"https://flint.etiennebacher.com/articles/adding_rules.html","id":"step-1-setup","dir":"Articles","previous_headings":"","what":"Step 1: setup","title":"Adding new rules","text":"need three things start experimenting new rules: example: can taken lintr’s examples specific linter. instance can already run lint_text(\".numeric(y) || .integer(y)\"). doesn’t return anything since haven’t implemented rule yet. rule: requires storing new YAML file inst/rules. can call one if_not_else.yml. store rule name (\"is_numeric\") list_linters(). Additionally, rules want add part lintr, can copy tests stored lintr test suite ensure rules cover corner cases.","code":""},{"path":"https://flint.etiennebacher.com/articles/adding_rules.html","id":"step-2-start-exploring","dir":"Articles","previous_headings":"","what":"Step 2: start exploring","title":"Adding new rules","text":"lintr::is_numeric_linter(), want warn one uses .numeric(y) || .integer(y) .integer(y) || .numeric(y) since equivalent .numeric(y). rule, can already add two patterns using : Running example now shows message: can see lintr::is_numeric_linter() examples cases warn. instance, class(z) %% c(\"numeric\", \"integer\") warn since equivalent .numeric(z), class(z) %% c(\"numeric\", \"integer\", \"factor\") shouldn’t. can add second rule YAML file adding separator ---: now works well: Notice however patterns rule use double quotation marks \". happens code single quotation marks ' instead? doesn’t work. remedy , can use strictness parameter ast-grep, comes sublevel pattern level. default, strictness smart want ignore quotation set ast (see examples): now wanted:","code":"id: is_numeric_1 language: r severity: warning rule:   any:     - pattern: is.numeric($VAR) || is.integer($VAR)     - pattern: is.integer($VAR) || is.numeric($VAR) message: is.numeric(x) is the same as is.numeric(x) || is.integer(x). Use     is.double(x) to test for objects stored as 64-bit floating point. lint_text(\"is.numeric(y) || is.integer(y)\") #> Original code: is.numeric(y) || is.integer(y)  #> Suggestion: is.numeric(x) || is.integer(x) can be simplified to is.numeric(x). Use is.double(x) to test for objects stored as 64-bit floating point. id: is_numeric_1 language: r severity: warning rule:   any:     - pattern: is.numeric($VAR) || is.integer($VAR)     - pattern: is.integer($VAR) || is.numeric($VAR) message: is.numeric(x) || is.integer(x) can be simplified to is.numeric(x). Use     is.double(x) to test for objects stored as 64-bit floating point.  ---  id: is_numeric_2 language: r severity: warning rule:   any:     - pattern: class($VAR) %in% c(\"numeric\", \"integer\")     - pattern: class($VAR) %in% c(\"integer\", \"numeric\") message: class(x) %in% c(\"numeric\", \"integer\") can be simplified to is.numeric(x). Use     is.double(x) to test for objects stored as 64-bit floating point. lint_text('class(z) %in% c(\"numeric\", \"integer\")') #> Original code: class(z) %in% c(\"numeric\", \"integer\")  #> Suggestion: class(x) %in% c(\"numeric\", \"integer\") can be simplified to is.numeric(x). Use is.double(x) to test for objects stored as 64-bit floating point. lint_text('class(z) %in% c(\"numeric\", \"integer\", \"factor\")') lint_text(\"class(z) %in% c('numeric', 'integer')\") id: is_numeric_2 language: r severity: warning rule:   any:     - pattern:         context: class($VAR) %in% c(\"numeric\", \"integer\")         strictness: ast     - pattern:         context: class($VAR) %in% c(\"integer\", \"numeric\")         strictness: ast message: class(x) %in% c(\"numeric\", \"integer\") can be simplified to is.numeric(x). Use     is.double(x) to test for objects stored as 64-bit floating point. lint_text(\"class(z) %in% c('numeric', 'integer')\") #> Original code: class(z) %in% c('numeric', 'integer')  #> Suggestion: class(x) %in% c(\"numeric\", \"integer\") can be simplified to is.numeric(x). Use is.double(x) to test for objects stored as 64-bit floating point.   lint_text('class(z) %in% c(\"numeric\", \"integer\")') #> Original code: class(z) %in% c('numeric', 'integer')  #> Suggestion: class(x) %in% c(\"numeric\", \"integer\") can be simplified to is.numeric(x). Use is.double(x) to test for objects stored as 64-bit floating point."},{"path":"https://flint.etiennebacher.com/articles/adding_rules.html","id":"step-3-corner-cases","dir":"Articles","previous_headings":"","what":"Step 3: corner cases","title":"Adding new rules","text":"want avoid false positives false negatives. rule exists lintr can copy section test suite tests rule. case, file.","code":""},{"path":"https://flint.etiennebacher.com/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"package maintainer. Maintainer.","code":""},{"path":"https://flint.etiennebacher.com/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Ww (2024). flint: Package (Title Case). R package version 0.1.0, https://github.com/etiennebacher/flint.","code":"@Manual{,   title = {flint: What the Package Does (Title Case)},   author = {Who wrote it},   year = {2024},   note = {R package version 0.1.0},   url = {https://github.com/etiennebacher/flint}, }"},{"path":"https://flint.etiennebacher.com/index.html","id":"flint","dir":"","previous_headings":"","what":"What the Package Does (Title Case)","title":"What the Package Does (Title Case)","text":"flint small R package find replace linters R code. Lint detections lint() Automatic replacement lints fix() Compatibility lintr rules Extremely fast Low-dependency flint powered astgrepr, built Rust crate ast-grep.","code":""},{"path":"https://flint.etiennebacher.com/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"What the Package Does (Title Case)","text":"Start setting flint flint::setup_flint(). stores set rules inst/flint/rules. can extend rules want control. flint provides two families functions: linting: lint(), lint_text(). replacing lints: fix(), fix_text()","code":""},{"path":"https://flint.etiennebacher.com/index.html","id":"comparison-with-existing-tools","dir":"","previous_headings":"","what":"Comparison with existing tools","title":"What the Package Does (Title Case)","text":"used tool lints detection R lintr. However, lintr’s performance optimal applied medium large packages. Also, lintr perform automatic replacement lints. styler package clean code fixing indentation things, doesn’t perform code replacement based lints. flint extremely performant. small benchmark 3.5k lines code three linters: One can also experiment flint::lint_text():","code":"library(bench) library(lintr) library(flint, warn.conflicts = FALSE)  file <- system.file(\"bench/test.R\", package = \"flint\")  bench::mark(   lintr::lint(file, linters = list(any_duplicated_linter(), any_is_na_linter(), matrix_apply_linter())),   flint::lint(file, linters = c(\"any_duplicated\", \"any_na\", \"matrix_apply\"), open = FALSE),   check = FALSE ) #> Warning: Some expressions had a GC in every iteration; so filtering is #> disabled. #> # A tibble: 2 × 6 #>   expression                            min  median `itr/sec` mem_alloc `gc/sec` #>   <bch:expr>                        <bch:t> <bch:t>     <dbl> <bch:byt>    <dbl> #> 1 \"lintr::lint(file, linters = lis…   3.01s   3.01s     0.332  314.34MB     9.63 #> 2 \"flint::lint(file, linters = c(\\… 59.82ms 69.06ms    13.5      6.61MB     1.93 lint_text(\" any(is.na(x)) any(duplicated(y)) \") #> Original code: any(is.na(x))  #> Suggestion: anyNA(x) is better than any(is.na(x)).  #>  #> Original code: any(duplicated(y))  #> Suggestion: anyDuplicated(x, ...) > 0 is better than any(duplicated(x), ...)."},{"path":"https://flint.etiennebacher.com/reference/fix.html","id":null,"dir":"Reference","previous_headings":"","what":"Hi there — fix","title":"Hi there — fix","text":"Hi ","code":""},{"path":"https://flint.etiennebacher.com/reference/fix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hi there — fix","text":"","code":"fix(path = \".\")  fix_text(text)"},{"path":"https://flint.etiennebacher.com/reference/flint-package.html","id":null,"dir":"Reference","previous_headings":"","what":"flint: What the Package Does (Title Case) — flint-package","title":"flint: What the Package Does (Title Case) — flint-package","text":"(maybe one line) Use four spaces indenting paragraphs within Description.","code":""},{"path":[]},{"path":"https://flint.etiennebacher.com/reference/lint.html","id":null,"dir":"Reference","previous_headings":"","what":"List all lints in a file or a directory — lint","title":"List all lints in a file or a directory — lint","text":"lint(), lint_text() lint_diff() produce list lints. difference input take: lint() takes path files directories lint_text() takes text input lint_diff() takes path directory looks files changed since last commit.","code":""},{"path":"https://flint.etiennebacher.com/reference/lint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List all lints in a file or a directory — lint","text":"","code":"lint(path = \".\", linters = NULL, open = TRUE)  lint_dir(path = \".\", linters = NULL, open = TRUE)  lint_package(path = \".\", linters = NULL, open = TRUE)  lint_text(text, linters = NULL)"},{"path":"https://flint.etiennebacher.com/reference/lint.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List all lints in a file or a directory — lint","text":"path valid path file directory. Relative paths accepted. linters character vector names rules apply. See entire list rules list_linters(). open TRUE (default) used RStudio IDE, lints shown markers.","code":""},{"path":"https://flint.etiennebacher.com/reference/lint.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List all lints in a file or a directory — lint","text":"dataframe row lint. columns show text, location (position text file found) severity.","code":""},{"path":"https://flint.etiennebacher.com/reference/setup_flint.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup flint — setup_flint","title":"Setup flint — setup_flint","text":"stores default rules internal files inst/flint. also imports sgconfig.yml used ast-grep. file must live root project renamed.","code":""},{"path":"https://flint.etiennebacher.com/reference/setup_flint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup flint — setup_flint","text":"","code":"setup_flint()"},{"path":"https://flint.etiennebacher.com/reference/setup_flint.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Setup flint — setup_flint","text":"Imports files necessary flint work return value R.","code":""}]

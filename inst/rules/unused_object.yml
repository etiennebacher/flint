id: unused_object-1
language: r
severity: warning
rule:
  kind: binary_operator
  all:
    - has:
        field: lhs
        kind: identifier
        pattern: $IDENT
    - not:
        precedes:
          stopBy: end
          any:
            - kind: identifier
              pattern: $IDENT
            - has:
                stopBy: end
                any:
                  - { kind: identifier, pattern: $IDENT }
                  - { has: {kind: identifier, pattern: $IDENT, stopBy: end}}

message: Object ~~IDENT~~ is unused in the rest of the code.

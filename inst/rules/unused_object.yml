id: unused_object-1
language: r
severity: warning
rule:
  kind: binary_operator
  regex: '<-'
  all:
    - has:
        field: lhs
        kind: identifier
        pattern: $IDENT
    - not:
        precedes:
          stopBy: end
          has:
            stopBy: end
            any:
              - kind: identifier
                pattern: $IDENT
              - has:
                  kind: identifier
                  pattern: $IDENT
                  stopBy: end

  # not:
  #   all:
  #     - precedes:
  #         pattern: $OBJ
  #         kind: identifier
  #         stopBy: end
  #     - precedes:
  #         kind: binary_operator
  #         has:
  #           pattern: $OBJ
  #           stopBy: end
# fix: ...
message: hello
